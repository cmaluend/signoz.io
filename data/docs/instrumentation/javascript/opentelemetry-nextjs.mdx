---
date: 2026-01-14
id: nextjs

title: Next.js OpenTelemetry Instrumentation
description: Learn how to instrument your Next.js application with OpenTelemetry and send traces to SigNoz
doc_type: howto
---

This guide shows you how to instrument your Next.js application with OpenTelemetry and send traces to SigNoz. You will use the `@vercel/otel` package for instrumentation of both server and edge runtime.

<KeyPointCallout title="Using self-hosted SigNoz?" defaultCollapsed={true}>
Most steps are identical. To adapt this guide, update the endpoint and remove the ingestion key header as shown in [Cloud to Self-Hosted](https://signoz.io/docs/ingestion/cloud-vs-self-hosted/#cloud-to-self-hosted).
</KeyPointCallout>

## Prerequisites

- Node.js 18 or later
- Next.js 13.4+ (App Router or Pages Router)
- A SigNoz Cloud account or self-hosted SigNoz instance

## Send traces to SigNoz

<Tabs entityName="deployment">
<TabItem value="vm" label="VM" default>

<KeyPointCallout title="What classifies as VM?" defaultCollapsed={true}>
A VM is a virtual computer that runs on physical hardware. This includes:
- **Cloud VMs**: AWS EC2, Google Compute Engine, Azure VMs, DigitalOcean Droplets
- **On-premise VMs**: VMware, VirtualBox, Hyper-V, KVM
- **Bare metal servers**: Physical servers running Linux/Unix directly

Use this section if you're deploying your Next.js application directly on a server or VM without containerization.
</KeyPointCallout>

### Step 1. Set environment variables

```bash
export OTEL_SERVICE_NAME="<service_name>"
export OTEL_EXPORTER_OTLP_TRACES_ENDPOINT="https://ingest.<region>.signoz.cloud:443/v1/traces"
export SIGNOZ_INGESTION_KEY="<your-ingestion-key>"
```

Replace the following:
- `<service_name>`: Name of your service (e.g., `nextjs-frontend`).
- `<region>`: Your SigNoz Cloud region (`us`, `eu`, or `in`). See [endpoints](https://signoz.io/docs/ingestion/signoz-cloud/overview/#endpoint).
- `<your-ingestion-key>`: Your SigNoz [ingestion key](https://signoz.io/docs/ingestion/signoz-cloud/keys/).

### Step 2. Install OpenTelemetry packages

```bash
npm install --save @vercel/otel @opentelemetry/api
```

### Step 3. Update next.config.mjs (Next.js 14 and below only)

<Admonition type="note">Skip this step if you are using Next.js 15 or later.</Admonition>

```tsx:next.config.mjs
/** @type {import('next').NextConfig} */
const nextConfig = {
  experimental: {
    instrumentationHook: true,
  },
}

export default nextConfig
```

### Step 4. Create the instrumentation file

Create `instrumentation.ts` (or `instrumentation.js`) in your project root or inside `src/` if you use that folder structure. Do not place it inside `app/` or `pages/`.

<Tabs>
<TabItem value="typescript" label="TypeScript" default>

```ts:instrumentation.ts
import { registerOTel, OTLPHttpJsonTraceExporter } from '@vercel/otel';
import { diag, DiagConsoleLogger, DiagLogLevel } from '@opentelemetry/api';

diag.setLogger(new DiagConsoleLogger(), DiagLogLevel.ERROR);

export function register() {
  registerOTel({
    serviceName: process.env.OTEL_SERVICE_NAME || 'nextjs-app',
    traceExporter: new OTLPHttpJsonTraceExporter({
      url: process.env.OTEL_EXPORTER_OTLP_TRACES_ENDPOINT || 'https://ingest.us.signoz.cloud:443/v1/traces',
      headers: process.env.SIGNOZ_INGESTION_KEY
        ? { 'signoz-ingestion-key': process.env.SIGNOZ_INGESTION_KEY }
        : undefined,
    }),
  });
}
```

</TabItem>
<TabItem value="javascript" label="JavaScript">

```js:instrumentation.js
const { registerOTel, OTLPHttpJsonTraceExporter } = require('@vercel/otel');
const { diag, DiagConsoleLogger, DiagLogLevel } = require('@opentelemetry/api');

diag.setLogger(new DiagConsoleLogger(), DiagLogLevel.ERROR);

exports.register = function register() {
  registerOTel({
    serviceName: process.env.OTEL_SERVICE_NAME || 'nextjs-app',
    traceExporter: new OTLPHttpJsonTraceExporter({
      url: process.env.OTEL_EXPORTER_OTLP_TRACES_ENDPOINT || 'https://ingest.us.signoz.cloud:443/v1/traces',
      headers: process.env.SIGNOZ_INGESTION_KEY
        ? { 'signoz-ingestion-key': process.env.SIGNOZ_INGESTION_KEY }
        : undefined,
    }),
  });
};
```

</TabItem>
</Tabs>

### Step 5. Run the application

```bash
npm run dev
```

</TabItem>

<TabItem value="k8s" label="Kubernetes">

<Tabs entityName="k8s-method">
<TabItem value="direct" label="Direct" default>

<KeyPointCallout title="Managing multiple services?" defaultCollapsed={true}>
If you're managing multiple services or want automatic instrumentation injection, consider using the [OTel Operator](#otel-operator) tab instead.
</KeyPointCallout>

### Step 1. Set environment variables

Add the following environment variables to your Kubernetes deployment manifest:

```yaml
env:
- name: OTEL_SERVICE_NAME
  value: '<service-name>'
- name: OTEL_EXPORTER_OTLP_TRACES_ENDPOINT
  value: 'https://ingest.<region>.signoz.cloud:443/v1/traces'
- name: SIGNOZ_INGESTION_KEY
  value: '<your-ingestion-key>'
```

Replace the following:
- `<service-name>`: Name of your service (e.g., `nextjs-frontend`).
- `<region>`: Your SigNoz Cloud region (`us`, `eu`, or `in`). See [endpoints](https://signoz.io/docs/ingestion/signoz-cloud/overview/#endpoint).
- `<your-ingestion-key>`: Your SigNoz [ingestion key](https://signoz.io/docs/ingestion/signoz-cloud/keys/).

### Step 2. Install OpenTelemetry packages

```bash
npm install --save @vercel/otel @opentelemetry/api
```

### Step 3. Create the instrumentation file

Create `instrumentation.ts` in your project root:

```ts:instrumentation.ts
import { registerOTel, OTLPHttpJsonTraceExporter } from '@vercel/otel';
import { diag, DiagConsoleLogger, DiagLogLevel } from '@opentelemetry/api';

diag.setLogger(new DiagConsoleLogger(), DiagLogLevel.ERROR);

export function register() {
  registerOTel({
    serviceName: process.env.OTEL_SERVICE_NAME || 'nextjs-app',
    traceExporter: new OTLPHttpJsonTraceExporter({
      url: process.env.OTEL_EXPORTER_OTLP_TRACES_ENDPOINT || 'https://ingest.us.signoz.cloud:443/v1/traces',
      headers: process.env.SIGNOZ_INGESTION_KEY
        ? { 'signoz-ingestion-key': process.env.SIGNOZ_INGESTION_KEY }
        : undefined,
    }),
  });
}
```

### Step 4. Deploy and run

Deploy your application to Kubernetes. The environment variables will be injected into your container and picked up by the instrumentation file.

</TabItem>
<TabItem value="otel-operator" label="OTel Operator">

The [OpenTelemetry Operator](https://signoz.io/docs/opentelemetry-collection-agents/k8s/otel-operator/overview/) auto-injects instrumentation into your Next.js pods without modifying your application image.

### Step 1. Set up the OpenTelemetry Operator

Install the Operator and Collector following the [K8s OTel Operator installation guide](https://signoz.io/docs/opentelemetry-collection-agents/k8s/otel-operator/install/).

### Step 2. Create the Instrumentation resource

Create `instrumentation.yaml` to configure Node.js auto-instrumentation:

```yaml:instrumentation.yaml
apiVersion: opentelemetry.io/v1alpha1
kind: Instrumentation
metadata:
  name: nodejs-instrumentation
spec:
  exporter:
    endpoint: http://otel-collector-collector:4318
  propagators:
    - tracecontext
    - baggage
  nodejs:
    image: ghcr.io/open-telemetry/opentelemetry-operator/autoinstrumentation-nodejs:latest
```

Deploy this resource to your cluster.

### Step 3. Add annotations to your deployment

Add these annotations to your pod template's `metadata.annotations`:

```yaml
instrumentation.opentelemetry.io/inject-nodejs: "true"
```

</TabItem>
</Tabs>

</TabItem>

<TabItem value="windows" label="Windows">

### Step 1. Set environment variables

```powershell
$env:OTEL_SERVICE_NAME="<service_name>"
$env:OTEL_EXPORTER_OTLP_TRACES_ENDPOINT="https://ingest.<region>.signoz.cloud:443/v1/traces"
$env:SIGNOZ_INGESTION_KEY="<your-ingestion-key>"
```

Replace the following:
- `<service_name>`: Name of your service (e.g., `nextjs-frontend`).
- `<region>`: Your SigNoz Cloud region (`us`, `eu`, or `in`). See [endpoints](https://signoz.io/docs/ingestion/signoz-cloud/overview/#endpoint).
- `<your-ingestion-key>`: Your SigNoz [ingestion key](https://signoz.io/docs/ingestion/signoz-cloud/keys/).

### Step 2. Install OpenTelemetry packages

```powershell
npm install --save @vercel/otel @opentelemetry/api
```

### Step 3. Update next.config.mjs (Next.js 14 and below only)

<Admonition type="note">Skip this step if you are using Next.js 15 or later.</Admonition>

```tsx
/** @type {import('next').NextConfig} */
const nextConfig = {
  experimental: {
    instrumentationHook: true,
  },
}

export default nextConfig
```

### Step 4. Create the instrumentation file

Create `instrumentation.ts` (or `instrumentation.js`) in your project root or inside `src/` if you use that folder structure. Do not place it inside `app/` or `pages/`.

<Tabs>
<TabItem value="typescript" label="TypeScript" default>

```ts:instrumentation.ts
import { registerOTel, OTLPHttpJsonTraceExporter } from '@vercel/otel';
import { diag, DiagConsoleLogger, DiagLogLevel } from '@opentelemetry/api';

diag.setLogger(new DiagConsoleLogger(), DiagLogLevel.ERROR);

export function register() {
  registerOTel({
    serviceName: process.env.OTEL_SERVICE_NAME || 'nextjs-app',
    traceExporter: new OTLPHttpJsonTraceExporter({
      url: process.env.OTEL_EXPORTER_OTLP_TRACES_ENDPOINT || 'https://ingest.us.signoz.cloud:443/v1/traces',
      headers: process.env.SIGNOZ_INGESTION_KEY
        ? { 'signoz-ingestion-key': process.env.SIGNOZ_INGESTION_KEY }
        : undefined,
    }),
  });
}
```

</TabItem>
<TabItem value="javascript" label="JavaScript">

```js:instrumentation.js
const { registerOTel, OTLPHttpJsonTraceExporter } = require('@vercel/otel');
const { diag, DiagConsoleLogger, DiagLogLevel } = require('@opentelemetry/api');

diag.setLogger(new DiagConsoleLogger(), DiagLogLevel.ERROR);

exports.register = function register() {
  registerOTel({
    serviceName: process.env.OTEL_SERVICE_NAME || 'nextjs-app',
    traceExporter: new OTLPHttpJsonTraceExporter({
      url: process.env.OTEL_EXPORTER_OTLP_TRACES_ENDPOINT || 'https://ingest.us.signoz.cloud:443/v1/traces',
      headers: process.env.SIGNOZ_INGESTION_KEY
        ? { 'signoz-ingestion-key': process.env.SIGNOZ_INGESTION_KEY }
        : undefined,
    }),
  });
};
```

</TabItem>
</Tabs>

### Step 5. Run the application

```powershell
npm run dev
```

</TabItem>

<TabItem value="docker" label="Docker">

### Step 1. Install OpenTelemetry packages

Add the packages to your `package.json`:

```bash
npm install --save @vercel/otel @opentelemetry/api
```

### Step 2. Create the instrumentation file

Create `instrumentation.ts` in your project root:

```ts:instrumentation.ts
import { registerOTel, OTLPHttpJsonTraceExporter } from '@vercel/otel';
import { diag, DiagConsoleLogger, DiagLogLevel } from '@opentelemetry/api';

diag.setLogger(new DiagConsoleLogger(), DiagLogLevel.ERROR);

export function register() {
  registerOTel({
    serviceName: process.env.OTEL_SERVICE_NAME || 'nextjs-app',
    traceExporter: new OTLPHttpJsonTraceExporter({
      url: process.env.OTEL_EXPORTER_OTLP_TRACES_ENDPOINT || 'https://ingest.us.signoz.cloud:443/v1/traces',
      headers: process.env.SIGNOZ_INGESTION_KEY
        ? { 'signoz-ingestion-key': process.env.SIGNOZ_INGESTION_KEY }
        : undefined,
    }),
  });
}
```

### Step 3. Configure your Dockerfile

```dockerfile:Dockerfile
FROM node:20-alpine AS base

FROM base AS deps
WORKDIR /app
COPY package.json package-lock.json* ./
RUN npm ci

FROM base AS builder
WORKDIR /app
COPY --from=deps /app/node_modules ./node_modules
COPY . .
RUN npm run build

FROM base AS runner
WORKDIR /app

ENV NODE_ENV=production

# OpenTelemetry configuration
ENV OTEL_SERVICE_NAME="nextjs-app"
ENV OTEL_EXPORTER_OTLP_TRACES_ENDPOINT="https://ingest.<region>.signoz.cloud:443/v1/traces"
ENV SIGNOZ_INGESTION_KEY="<your-ingestion-key>"

RUN addgroup --system --gid 1001 nodejs
RUN adduser --system --uid 1001 nextjs

COPY --from=builder /app/public ./public
COPY --from=builder --chown=nextjs:nodejs /app/.next/standalone ./
COPY --from=builder --chown=nextjs:nodejs /app/.next/static ./.next/static

USER nextjs

EXPOSE 3000

CMD ["node", "server.js"]
```

Or pass environment variables at runtime:

```bash
docker run -e OTEL_SERVICE_NAME="nextjs-app" \
  -e OTEL_EXPORTER_OTLP_TRACES_ENDPOINT="https://ingest.<region>.signoz.cloud:443/v1/traces" \
  -e SIGNOZ_INGESTION_KEY="<your-ingestion-key>" \
  -p 3000:3000 your-nextjs-image:latest
```

Replace the following:
- `<region>`: Your SigNoz Cloud region (`us`, `eu`, or `in`).
- `<your-ingestion-key>`: Your SigNoz [ingestion key](https://signoz.io/docs/ingestion/signoz-cloud/keys/).

</TabItem>
</Tabs>

<details>
<ToggleHeading>
## For Next.js 14 and below
</ToggleHeading>

### Why is this required?

In Next.js 14 and earlier versions, the instrumentation feature was experimental and required explicit opt-in through a configuration flag.

### How to enable it

Add the following to your `next.config.mjs`:

```tsx:next.config.mjs
/** @type {import('next').NextConfig} */
const nextConfig = {
  experimental: {
    instrumentationHook: true,
  },
}

export default nextConfig
```

### What changed in Next.js 15?

In [Next.js 15](https://nextjs.org/blog/next-15), the `instrumentation.js` API was promoted from experimental to stable. This means:

- The `experimental.instrumentationHook` config option is no longer needed
- You can simply create an `instrumentation.ts` file without any additional configuration
- A new `onRequestError` hook was introduced for better error tracking integration

</details>

## Validate

After running your instrumented application, verify traces appear in SigNoz:

1. Generate traffic by making requests to your application.
2. Open SigNoz and navigate to **Services**.
3. Click **Refresh** and look for your service name.
4. Go to **Traces** and filter by your service to inspect spans.

<details>
<ToggleHeading>
## Troubleshooting
</ToggleHeading>

### Traces are not appearing in SigNoz

**Check the instrumentation file location:**
The file must be in the project root or `src/` folder, not inside `app/` or `pages/`.

**Enable debug logging:**
Change `DiagLogLevel.ERROR` to `DiagLogLevel.DEBUG` in your instrumentation file to see detailed output.

**Verify endpoint connectivity:**

```bash
curl -v https://ingest.<region>.signoz.cloud:443/v1/traces
```

### Instrumentation hook not working (Next.js 14 and below)

Make sure `instrumentationHook: true` is set in `next.config.mjs` under `experimental`.

### Edge runtime traces missing

The `@vercel/otel` package supports edge runtime. Ensure your instrumentation file exports a `register` function and that it runs in both Node.js and edge environments.

### Service not appearing in Services tab

- Wait a few minutes for data to propagate
- Make actual requests to your app (not just health checks)
- Verify your ingestion key is correct
- Check that the region in the endpoint matches your SigNoz Cloud region

### CORS errors when sending traces

If you see CORS errors, you may be accidentally trying to send traces from the browser. The `@vercel/otel` instrumentation only runs server-side. For browser-side tracing, see the [frontend monitoring guide](https://signoz.io/docs/frontend-monitoring/sending-traces-with-opentelemetry/).

</details>

<details>
<ToggleHeading>
## Setup OpenTelemetry Collector (Optional)
</ToggleHeading>

### What is the OpenTelemetry Collector?

The OTel Collector acts as a middleman between your app and SigNoz. Instead of sending data directly, your application sends everything to the Collector first, which then forwards it along.

### Why use it?

- **Cleaning up data** — Filter out noisy traces you don't care about, or remove sensitive info before it leaves your servers.
- **Keeping your app lightweight** — Let the Collector handle batching, retries, and compression instead of your application code.
- **Adding context automatically** — The Collector can tag your data with useful info like which Kubernetes pod or cloud region it came from.
- **Future flexibility** — Want to send data to multiple backends later? The Collector makes that easy without changing your app.

See [Switch from direct export to Collector](https://signoz.io/docs/opentelemetry-collection-agents/opentelemetry-collector/switch-to-collector/) for step-by-step instructions.

</details>

## Sample application

Check out the [Sample Next.js App](https://github.com/SigNoz/sample-nextjs-app) for a complete working example.

## Next steps

- [Instrument the client-side of your Next.js app](https://signoz.io/docs/frontend-monitoring/sending-traces-with-opentelemetry/)
- [Capture frontend metrics, logs, and vitals](https://signoz.io/docs/frontend-monitoring/)
- [Correlate traces with logs](https://signoz.io/docs/traces-management/guides/correlate-traces-and-logs/)
- [Set up alerts for your application](https://signoz.io/docs/alerts-management/notification-channel/slack/)

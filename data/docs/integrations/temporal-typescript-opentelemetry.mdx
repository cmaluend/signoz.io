---
date: 2026-01-22
id: temporal-typescript-opentelemetry
title: Instrumenting a Temporal application in typescript with OpenTelemetry
description: Learn how to instrument a Temporal TypeScript application with OpenTelemetry and export data to SigNoz.
doc_type: howto
---

import GetHelp from '@/components/shared/get-help.md'

Learn how to instrument a Temporal TypeScript application with OpenTelemetry and send traces, metrics, and logs to SigNoz.

## What is Temporal?

Temporal is a durable workflow execution platform that helps you build reliable distributed systems. Unlike traditional REST APIs that handle single requests, Temporal manages **long-running workflows** that can span hours, days, or even months - coordinating multiple steps, retries, and state management automatically.

### Why Does Temporal Have Workers and Clients?

Temporal applications have a unique architecture:

- **Temporal Client**: Starts workflows and queries their status. Think of this as your application's entry point that says "start this process."
- **Temporal Worker**: Executes the actual workflow code and activities. Workers poll the Temporal server for tasks and run your business logic.
- **Workflows**: Durable functions that define your business process (e.g., "process an order: charge card, reserve inventory, send confirmation")
- **Activities**: Individual tasks within workflows (e.g., "call payment API," "update database")

This separation allows Temporal to provide fault tolerance - if a worker crashes mid-workflow, another worker can pick up exactly where it left off.

## Prerequisites

Before starting, ensure you have:
- Node.js 16+ and npm/yarn installed
- A running Temporal server (local or Temporal Cloud)
- A SigNoz Cloud account ([sign up here](https://signoz.io/teams/)) or [self-hosted SigNoz](https://signoz.io/docs/install/)

<KeyPointCallout title="Using self-hosted SigNoz?" defaultCollapsed={true}>
Most steps are identical. To adapt this guide, update the endpoint and remove the ingestion key header as shown in [Cloud → Self-Hosted](https://signoz.io/docs/ingestion/cloud-vs-self-hosted/#cloud-to-self-hosted).
</KeyPointCallout>

## Sample Application

We've published a complete example application at <a href="https://github.com/SigNoz/temporal-typescript-opentelemetry" target="_blank" rel="noopener noreferrer nofollow">GitHub</a>. Follow along with the code as you work through this guide.

## Architecture Overview

Here's how OpenTelemetry integrates with your Temporal application:

<Figure
  src="/img/docs/integrations/temporal/golang/architecture.svg"
  alt="Architecture Diagram"
  caption="Architecture Diagram"
/>

Each component (client, worker, workflows, activities) gets instrumented to capture traces, metrics, and logs.

## Setup

### Step 1: Add Dependencies

Add OpenTelemetry and Temporal packages to your `package.json`:

```json:package.json
{
  "dependencies": {
    "@opentelemetry/auto-instrumentations-node": "^0.55.0",
    "@opentelemetry/core": "^1.30.0",
    "@opentelemetry/exporter-metrics-otlp-grpc": "^0.57.0",
    "@opentelemetry/exporter-trace-otlp-grpc": "^0.57.0",
    "@opentelemetry/resources": "^1.30.0",
    "@opentelemetry/sdk-metrics": "^1.30.0",
    "@opentelemetry/sdk-node": "^0.57.0",
    "@opentelemetry/sdk-trace-node": "^1.30.0",
    "@opentelemetry/semantic-conventions": "^1.28.0",
    "@opentelemetry/winston-transport": "^0.11.0",
    "@temporalio/activity": "^1.11.6",
    "@temporalio/client": "^1.11.6",
    "@temporalio/interceptors-opentelemetry": "^1.11.7",
    "@temporalio/worker": "^1.11.6",
    "@temporalio/workflow": "^1.11.6"
  }
}
```

Install the packages:
```bash
npm install
```

### Step 2: Configure OpenTelemetry SDK

Create `src/instrumentation.ts` to set up the OpenTelemetry SDK. This file initializes tracing, metrics, and logging for your entire application.

**Key concept**: This configuration must be loaded **before** any other code to ensure automatic instrumentation works correctly.

```typescript:src/instrumentation.ts
import { config } from 'dotenv';
config(); // Load environment variables first

import { NodeSDK } from '@opentelemetry/sdk-node';
import { OTLPTraceExporter } from '@opentelemetry/exporter-trace-otlp-grpc';
import { OTLPMetricExporter } from '@opentelemetry/exporter-metrics-otlp-grpc';
import { PeriodicExportingMetricReader } from '@opentelemetry/sdk-metrics';
import { getNodeAutoInstrumentations } from '@opentelemetry/auto-instrumentations-node';
import { Resource } from '@opentelemetry/resources';
import { ATTR_SERVICE_NAME } from '@opentelemetry/semantic-conventions';

// Parse authentication headers from environment
function parseHeaders(headersString: string | undefined): Record<string, string> {
  if (!headersString) return {};
  const headers: Record<string, string> = {};
  headersString.split(',').forEach((pair) => {
    const [key, value] = pair.split('=');
    if (key && value) headers[key.trim()] = value.trim();
  });
  return headers;
}

export const otlpHeaders = parseHeaders(process.env.OTEL_EXPORTER_OTLP_HEADERS);

// Set up resource with service name
const serviceName = process.env.OTEL_SERVICE_NAME || 'temporal-typescript-app';
export const resource = new Resource({
  [ATTR_SERVICE_NAME]: serviceName,
});

// Configure trace exporter (sends traces to SigNoz)
export const traceExporter = new OTLPTraceExporter({
  headers: otlpHeaders,
  timeoutMillis: 10000,
});

// Configure metric reader (sends metrics to SigNoz)
const metricReader = new PeriodicExportingMetricReader({
  exporter: new OTLPMetricExporter({
    headers: otlpHeaders,
    timeoutMillis: 10000,
  }),
});

// Initialize OpenTelemetry SDK
export const otelSdk = new NodeSDK({
  resource,
  traceExporter,
  metricReader,
  instrumentations: [getNodeAutoInstrumentations()],
});

otelSdk.start();
console.log('[OpenTelemetry] SDK initialized successfully');
```

**What this does**:
- Reads your SigNoz endpoint and ingestion key from environment variables
- Sets up trace and metric exporters to send data to SigNoz using OTLP/gRPC
- Enables automatic instrumentation for Node.js libraries (HTTP, DNS, etc.)
- Must be imported first in your client and worker files

### Step 3: Instrument the Temporal Client

The Temporal Client starts workflows and queries their status. Add OpenTelemetry instrumentation to trace these operations.

```typescript:src/client.ts {1,7-9}
import { otelSdk } from './instrumentation'; // MUST be first import
import { Client } from '@temporalio/client';
import { OpenTelemetryWorkflowClientInterceptor } from '@temporalio/interceptors-opentelemetry';

async function run() {
  try {
    const client = new Client({
      interceptors: {
        workflow: [new OpenTelemetryWorkflowClientInterceptor()],
      },
    });

    // Start a workflow
    const handle = await client.workflow.start('myWorkflow', {
      taskQueue: 'my-task-queue',
      workflowId: 'my-workflow-id',
    });

    console.log(`Started workflow: ${handle.workflowId}`);
  } finally {
    await otelSdk.shutdown(); // Clean shutdown
  }
}

run().catch(console.error);
```

**What this does**:
- The `OpenTelemetryWorkflowClientInterceptor` automatically creates spans for workflow start, signal, and query operations
- Each workflow operation becomes a trace you can view in SigNoz
- Always import `instrumentation.ts` first to enable auto-instrumentation

### Step 4: Instrument the Temporal Worker

The Temporal Worker executes workflow and activity code. This is where most of your business logic runs, so instrumentation here is critical.

```typescript:src/worker.ts {1,15-27}
import { otelSdk, otlpHeaders, resource, traceExporter } from './instrumentation'; // MUST be first
import { 
  DefaultLogger, 
  makeTelemetryFilterString, 
  NativeConnection, 
  Runtime, 
  Worker 
} from '@temporalio/worker';
import {
  OpenTelemetryActivityInboundInterceptor,
  OpenTelemetryActivityOutboundInterceptor,
  makeWorkflowExporter,
} from '@temporalio/interceptors-opentelemetry/lib/worker';

// Configure Temporal's runtime telemetry
Runtime.install({
  telemetryOptions: {
    metrics: {
      otel: {
        url: process.env.OTEL_EXPORTER_OTLP_ENDPOINT,
        headers: otlpHeaders,
        metricsExportInterval: 10000,
      },
    },
  },
});

async function run() {
  try {
    const worker = await Worker.create({
      workflowsPath: require.resolve('./workflows'),
      taskQueue: 'my-task-queue',
      
      // Export workflow traces
      sinks: traceExporter && {
        exporter: makeWorkflowExporter(traceExporter, resource),
      },
      
      // Instrument activities
      interceptors: {
        workflowModules: [require.resolve('./workflows')],
        activity: [
          (ctx) => ({
            inbound: new OpenTelemetryActivityInboundInterceptor(ctx),
            outbound: new OpenTelemetryActivityOutboundInterceptor(ctx),
          }),
        ],
      },
    });

    await worker.run();
  } finally {
    await otelSdk.shutdown();
  }
}

run().catch(console.error);
```

**What this does**:
- `Runtime.install()` sends Temporal's internal metrics (worker health, task queue lag) to SigNoz
- `makeWorkflowExporter()` exports traces from workflow execution
- Activity interceptors capture spans for each activity invocation
- You'll see the entire workflow execution as a distributed trace in SigNoz

### Step 5: Instrument Workflows

Workflows define your business process. Add interceptors to trace workflow execution, timers, and child workflows.

```typescript:src/workflows.ts
import { WorkflowInterceptorsFactory } from '@temporalio/workflow';
import {
  OpenTelemetryInboundInterceptor,
  OpenTelemetryOutboundInterceptor,
  OpenTelemetryInternalsInterceptor,
} from '@temporalio/interceptors-opentelemetry/lib/workflow';

// Your workflow interceptors
export const interceptors: WorkflowInterceptorsFactory = () => ({
  inbound: [new OpenTelemetryInboundInterceptor()],
  outbound: [new OpenTelemetryOutboundInterceptor()],
  internals: [new OpenTelemetryInternalsInterceptor()],
});

// Example workflow
export async function myWorkflow(): Promise<string> {
  // Your workflow logic here
  return 'completed';
}
```

**What this does**:
- `OpenTelemetryInboundInterceptor` traces incoming signals and queries
- `OpenTelemetryOutboundInterceptor` traces outgoing activity calls
- `OpenTelemetryInternalsInterceptor` traces internal workflow operations like timers and child workflows

### Step 6: Configure Logging (Optional)

Connect Winston logging to OpenTelemetry to send logs to SigNoz alongside traces and metrics.

```typescript:src/logger.ts
import { otlpHeaders, resource } from './instrumentation';
import winston from 'winston';
import { OTLPLogExporter } from '@opentelemetry/exporter-logs-otlp-grpc';
import { logs } from '@opentelemetry/api-logs';
import { LoggerProvider, SimpleLogRecordProcessor } from '@opentelemetry/sdk-logs';
import { OpenTelemetryTransportV3 } from '@opentelemetry/winston-transport';

// Initialize log provider
const loggerProvider = new LoggerProvider({ resource });
const otlpExporter = new OTLPLogExporter({ headers: otlpHeaders });
loggerProvider.addLogRecordProcessor(new SimpleLogRecordProcessor(otlpExporter));
logs.setGlobalLoggerProvider(loggerProvider);

// Create Winston logger
export const logger = winston.createLogger({
  level: 'info',
  format: winston.format.json(),
  transports: [
    new winston.transports.Console(),
    new OpenTelemetryTransportV3(),
  ],
});
```

Use this logger in your worker configuration by passing it to `Runtime.install({ logger })`.

### Step 7: Run Your Application

Set environment variables and start your worker and client:

**Start the worker:**

```bash
OTEL_SERVICE_NAME="temporal-worker" \
OTEL_EXPORTER_OTLP_ENDPOINT="https://ingest.us.signoz.cloud:443" \
OTEL_EXPORTER_OTLP_HEADERS="signoz-ingestion-key=<YOUR_INGESTION_KEY>" \
OTEL_RESOURCE_ATTRIBUTES="deployment.environment=production" \
npm run start
```

**Start the client (in another terminal):**

```bash
OTEL_SERVICE_NAME="temporal-client" \
OTEL_EXPORTER_OTLP_ENDPOINT="https://ingest.us.signoz.cloud:443" \
OTEL_EXPORTER_OTLP_HEADERS="signoz-ingestion-key=<YOUR_INGESTION_KEY>" \
OTEL_RESOURCE_ATTRIBUTES="deployment.environment=production" \
npm run workflow
```

**Replace the following placeholders:**

- `<YOUR_INGESTION_KEY>`: Your SigNoz ingestion key from [ingestion keys page](https://signoz.io/docs/ingestion/signoz-cloud/keys/)
- Region: Change `us` to `eu` or `in` based on your SigNoz Cloud region

## Validate in SigNoz

After running your application, verify that data is flowing to SigNoz:

1. **View Traces**:
   - Go to **Services** → find `temporal-worker` and `temporal-client`
   - Click into a service to see traces
   - You'll see spans for workflow starts, activity executions, and signals
   
2. **View Metrics**:
   - Go to **Dashboards** → Import the <a href="https://github.com/SigNoz/dashboards/blob/main/temporal.io/Temporal%20SDK%20Metrics%20-%20typescript.json" target="_blank" rel="noopener noreferrer nofollow">Temporal SDK Metrics dashboard</a>
   - Click **Import JSON** and paste the dashboard JSON
   - View worker health, task queue metrics, and workflow/activity durations

3. **View Logs**:
   - Go to **Logs** → you should see logs from your worker and client
   - Use the Logs Pipeline feature to parse JSON logs:
     - Add a JSON parser: [JSON parser docs](https://signoz.io/docs/logs-pipelines/processors/#json-parser)
     - Map trace IDs: [Trace parser docs](https://signoz.io/docs/logs-pipelines/processors/#trace-parser)
     - Map log levels: [Severity parser docs](https://signoz.io/docs/logs-pipelines/processors/#severity-parser)

<Figure
  src="/img/docs/integrations/temporal/golang/distributed-trace.webp"
  alt="Distributed trace from a Temporal application"
  caption="Distributed trace showing workflow execution across client, worker, and activities"
/>

<Figure
  src="/img/docs/integrations/temporal/golang/logs.webp"
  alt="JSON logs from a Temporal application"
  caption="Application logs from your Temporal worker in SigNoz"
/>

<Figure
  src="/img/docs/integrations/temporal/golang/sdk-metrics.webp"
  alt="SDK metrics from a Temporal application"
  caption="Temporal SDK metrics dashboard showing worker health and task queue metrics"
/>


<details>
<ToggleHeading>

## Troubleshooting

</ToggleHeading>

### Common Issues

#### No data appearing in SigNoz

**Symptom**: Worker and client run without errors, but no traces/metrics appear in SigNoz.

**Causes and fixes**:
1. **Wrong endpoint or region**:
   - Verify your endpoint matches your SigNoz region: `https://ingest.<region>.signoz.cloud:443`
   - Check available regions at [SigNoz Cloud endpoints](https://signoz.io/docs/ingestion/signoz-cloud/overview/#endpoint)

2. **Invalid ingestion key**:
   - Confirm your key at [SigNoz ingestion keys page](https://signoz.io/docs/ingestion/signoz-cloud/keys/)
   - Check for typos or extra whitespace in the `OTEL_EXPORTER_OTLP_HEADERS` value

3. **Network/firewall issues**:
   - Test connectivity: `curl -v https://ingest.us.signoz.cloud:443`
   - Ensure outbound HTTPS (port 443) is allowed

4. **SDK not initialized**:
   - Verify `instrumentation.ts` is the **first import** in both `client.ts` and `worker.ts`
   - Check console for `[OpenTelemetry] SDK initialized successfully`

#### Error: "Failed to export traces"

**Symptom**: Console shows `Failed to export traces` or timeout errors.

**Cause**: Network issues or incorrect exporter configuration.

**Fix**:
1. Increase timeout in `instrumentation.ts`:
   ```typescript
   export const traceExporter = new OTLPTraceExporter({
     headers: otlpHeaders,
     timeoutMillis: 30000, // Increase from 10s to 30s
   });
   ```
2. Check if your network requires a proxy and set `HTTP_PROXY`/`HTTPS_PROXY` environment variables

#### Traces appear but logs don't

**Symptom**: Traces and metrics work, but logs are missing.

**Fix**:
1. Verify `logger.ts` is imported and used in your worker
2. Check that `OpenTelemetryTransportV3` is in Winston transports
3. Set up log parsing pipeline in SigNoz (see Validate section above)

#### High cardinality warning

**Symptom**: SigNoz shows warnings about high cardinality metrics.

**Cause**: Temporal can generate many metrics with unique label combinations.

**Fix**: Configure metric filtering in `Runtime.install()`:
```typescript
Runtime.install({
  telemetryOptions: {
    metrics: {
      otel: {
        url: process.env.OTEL_EXPORTER_OTLP_ENDPOINT,
        headers: otlpHeaders,
      },
      // Filter out noisy metrics
      filter: makeTelemetryFilterString({
        core: 'INFO',
        other: 'WARN',
      }),
    },
  },
});
```

</details>

## Next Steps

Now that your Temporal application is instrumented:

- **Set up alerts**: Create alerts for workflow failures, high activity latency, or worker health issues in [SigNoz Alerts](https://signoz.io/docs/userguide/alerts-management/)
- **Build dashboards**: Customize the <a href="https://github.com/SigNoz/dashboards/blob/main/temporal.io/Temporal%20SDK%20Metrics%20-%20typescript.json" target="_blank" rel="noopener noreferrer nofollow">Temporal SDK dashboard</a> or create your own
- **Explore traces**: Use the [Traces Explorer](https://signoz.io/docs/userguide/traces/) to debug failed workflows
- **Query logs**: Learn advanced log queries in the [Logs documentation](https://signoz.io/docs/userguide/logs/)
- **Monitor activities**: Track activity execution times and error rates

## Get Help

<GetHelp />

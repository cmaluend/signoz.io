#!/usr/bin/env sh

set -e

echo 'husky (pre-commit): running lint-staged'
yarn lint-staged

STAGED_FILES=$(git diff --cached --name-only)

if printf '%s\n' "$STAGED_FILES" | grep -E '^(data/docs/.*\.mdx|next\.config\.js|scripts/check-doc-redirects\.js)$' >/dev/null; then
  echo 'husky (pre-commit): verifying docs redirects'
  yarn check:doc-redirects
else
  echo 'husky (pre-commit): skipping docs redirect check (no relevant changes staged)'
fi
